# Configuration for The Crypto Bot for Kalshi

# Data settings
data:
  exchange: "binance"
  symbols:
    primary: "BTC/USDT"
    context:
      - "ETH/USDT"
  base_timeframe: "1m"
  target_timeframe: "15m"
  history_days: 365
  fetch:
    limit: 1500
    max_batches: 8000
    sleep_seconds: 0.2
  alt_data:
    funding_rates: true
    open_interest: true
    perp_suffix: ":USDT"
    include_context: false
  live:
    history_hours: 96
    refresh_minutes: 15

# Feature engineering
features:
  version: "v2"
  lookback_bars: [1, 2, 4, 8, 16, 32, 64, 96]
  volatility_windows: [8, 16, 32, 96]
  volume_windows: [4, 16, 64]
  context_correlation_windows: [8, 32, 96]
  include_intraday: true
  include_regime: true
  include_interactions: true
  target:
    horizon_bars: 1
    # Increased threshold to reduce false signals and trading frequency
    # 0.0015 = 15 bps, more appropriate for 15m timeframe with fees
    classification_threshold: 0.0015
    neutral_band: 0.0005

# Model settings
model:
  type: "lookahead_xgboost"
  classification_params:
    max_depth: 4
    learning_rate: 0.07
    n_estimators: 600
    subsample: 0.9
    colsample_bytree: 0.8
    gamma: 0.0
    min_child_weight: 3
  regression_params:
    max_depth: 5
    learning_rate: 0.05
    n_estimators: 800
    subsample: 0.85
    colsample_bytree: 0.8
    gamma: 0.0
    min_child_weight: 2
  training:
    test_size: 0.2
    early_stopping_rounds: 50
    eval_metric_classification: "auc"
    eval_metric_regression: "rmse"
    random_state: 42
  thresholds:
    probability_long: 0.55
    probability_short: 0.45
    min_expected_return: 0.0005
    neutral_absolute_return: 0.0002

# Backtest settings
backtest:
  initial_capital: 10000.0
  walkforward_windows: 12
  train_test_split: 0.8
  purge_ratio: 0.02
  embargo_ratio: 0.02
  commission: 0.0005
  annualization_factor: 35040

# Trading settings
trading:
  max_position_size: 0.2
  stop_loss: 0.03
  take_profit: 0.06
  commission: 0.0005
  min_probability: 0.55
  # Increased min_expected_return to account for fees and slippage
  min_expected_return: 0.001

# Live trading settings
live_trading:
  mode: "paper"  # paper or live
  interval_minutes: 15
  initial_capital: 10000.0
  max_daily_loss: 500.0
  max_consecutive_losses: 5
  # Kalshi API settings (optional, for live mode)
  kalshi:
    api_key: ""  # Set via environment variable KALSHI_API_KEY
    private_key_path: ""  # Path to private key file
    use_demo: true  # Use demo environment for testing

# Hyperparameter tuning settings
tuning:
  n_trials: 50
  timeout_seconds: 3600
  n_cv_splits: 5
  optimize_metric: "roc_auc"  # roc_auc, sharpe, f1, expectancy
  purge_bars: 2
